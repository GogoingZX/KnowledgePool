---
title: "ST5202_Tut_2_ZHU_Xu"
author: 
- Name:Zhu Xu
- User ID:E0337988
- Student ID:A0131944H
date: "2019/2/19"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
\rule[-5pt]{16.3cm}{0.15em}
\linespread{1.3}

###Question_1:

```{r}
data<-read.table(
  '/Users/xuzhu/Desktop/Notes/Sem2/ST5202-Applied_Regression_Analysis/Tut/copier_maintenance.txt')
X<-data[,2]
Y<-data[,1]
n=length(Y)
reg<-lm(Y~X)
newobs=data.frame(Y=c(NA),X=c(6))
CI=predict(reg, newdata = newobs, interval = 'confidence', level=0.90)
PL=predict(reg, newdata = newobs, interval = 'predict', level=0.90)
```

####a)
```{r}
summary(CI)
```

####b)
```{r}
summary(PL)
```

\newpage
###Question_2:

####a)
```{r}
summary(reg)
t_value = 31.123
s_b1 = 0.4831
t_value < qt((1-0.01/2),(n-2))
#reject H_0
```

####b)
```{r}
t_value < qt((1-0.01),(n-2))
#reject H_0
```

####c)
```{r}
U = reg$coefficients[2]+qt((1-0.01/2),(n-2))*s_b1
L = reg$coefficients[2]-qt((1-0.01/2),(n-2))*s_b1
c(L,U)
```

\newpage
###Question_3:

####a)

\begin{center}
Full Model: $Y=\beta_0+\beta_1X+\epsilon$

Reduced Model: $Y=\beta_0+\epsilon$
\end{center}

####b)
```{r}
anova(reg)
#SSE(F)=3416
#SSE(R)=76960
#dfF=43
#dfR=1
F=968.66
F < qf(0.99,1,(n-2))
p_value = 1-pf(F,1,(n-2))
p_value
```

####c)

\begin{center}
$qT(1-\frac{0.01}{2})^2=qF(0.99,1,(n-2))$

$(\frac{b_1}{s\{b_1\}})^2=\frac{SSR}{MSE}$

$\Rightarrow\quad equivalent$
\end{center}

\newpage
###Question_4:

####a)
```{r}
dotchart(X)
```

####b)
```{r}
plot(X,type = 'b')
```

\newpage
####c)
```{r}
stem(reg$residuals)
```

####d)
```{r}
plot(reg$fitted.values,reg$residuals,pch=18)
plot(X,reg$residuals,pch=18)
```

####e)
```{r}
qqnorm(reg$residuals)
cc=cor(qqnorm(reg$residuals)$x,qqnorm(reg$residuals)$y)
cc #cc>critical value
```

####f)
```{r}
plot(reg$residuals,type = 'b')
```

####g)
```{r}
#BFtest
index=which(X<=median(X))
e1=reg$residuals[index]
e2=reg$residuals[-index]
d1=e1-median(e1)
d2=e2-median(e2)
n1=length(d1)
n2=length(d2)
temp1=sum((d1-mean(d1))^2)
temp2=sum((d2-mean(d2))^2)
s=sqrt((temp1+temp2)/(n-2))
tBF=(mean(d1)-mean(d2))/sqrt(1/n1+1/n2)/s
tBF<qt((1-0.05/2),(n-2))
#CONSTANT
```

\newpage
####h)
```{r}
newdata<-read.table(
  '/Users/xuzhu/Desktop/Notes/Sem2/ST5202-Applied_Regression_Analysis/Tut/q3_4.txt')
X2=newdata[,3]
X3=newdata[,4]
par(mfrow=c(1,2))
plot(X2,reg$residuals)
plot(X3,reg$residuals)
```

\newpage
###Quetion_5:

####a+b)
```{r}
SC<-read.table(
  '/Users/xuzhu/Desktop/Notes/Sem2/ST5202-Applied_Regression_Analysis/Tut/solution_concentration.txt')
y = SC[,1]
x = SC[,2]
reg1 = lm(y~x)
colnames(SC) = c('y','x')
full.model = lm(y~factor(x),data = SC)
reduced.model = reg1
anova(reduced.model,full.model)
F_statistics = 58.603
F_statistics > qf((1-0.025),3,length(x)-5)
#reject H_0
```

####c)
```{r}
#SSE(F)=0.1574
#SSE(R)=2.9247
#dfF=10
#dfR=13
F_statistics=58.603
p_value1 = 1-pf(F_statistics,3,length(x)-5)
p_value1
```

####d+e)

The test in b is not enough to judge, we also need further study of residuals.

\newpage
###Question_6:

####a)
```{r}
par(mfrow=c(1,1))
plot(x,y)
#Y'=log10Y is approriate.
```

####c)
```{r}
ytransform=log10(y)
reg2=lm(ytransform~x)
summary(reg2)
```

####d)
```{r}
b0<-reg2$coefficients[1]
b1<-reg2$coefficients[2]
plot(x,ytransform)
abline(b0,b1,col='red')
```

\newpage
####e)
```{r}
par(mfrow=c(1,2))
plot(reg2$fitted.values,reg2$residuals)
qqnorm(reg2$residuals)
```

####f)
```{r}
b1
b0
```

\begin{center}
$log(y)=0.6548798-0.1954003x$

$y=exp\{0.6548798-0.1954003x\}$

$y=4.517309exp\{-0.1954003x\}$
\end{center}












