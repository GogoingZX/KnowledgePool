---
title: "ST5218_Tut_4"
author: 
- Name:Zhu Xu
- User ID:E0337988
- Matriculation ID:A0191344H
date: "20/Feb/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
\rule[-5pt]{16.3cm}{0.15em}
\linespread{1.3}

###Question_1:

####a)

$$w_1=\frac{\sum^{-1}I}{I^T\sum^{-1}I}$$

####b)

\begin{center}
$r_{target}=0.0111$

$w=\frac{c-br_{target}}{ac-b^2}\sum^{-1}I+\frac{ar_{target}-b}{ac-b^2}\sum^{-1}r$

$\Rightarrow\quad w_2=(0.1045060,0.4694433,0.1067702,0.3192805)^T$
\end{center}

####c)

$$w_c=\alpha w_2+(1-\alpha)w_1=(0.1099927,0.4535539,0.1229246,0.3135288)^T$$

####d)

$$w_c=\alpha w_2+(1-\alpha)w_1$$

####e)

$$R\sim N(\mu,\sum)$$

$$w^TR\sim N(w^T\mu,w^T\sum w)$$

$$VaR=0.01832235$$

###Question_2:

\begin{center}
Let $L(w,\lambda)=w^T\mu-\frac{1}{2}w^T\sum w-\lambda(w^TI-1)\quad$ where $I=(1,\cdots,1)^T$
\end{center}
The first order condition is,
\begin{center}
$\mu-\sum w-\lambda I=0,\qquad w^TI=1$

$\Rightarrow\quad w=\sum^{-1}(\mu-\lambda)$
\end{center}

By the constraint,
\begin{center}
$I^T\sum^{-1}\mu-I^T\sum^{-1}I\lambda=1$

$\lambda=\frac{I^T\sum^{-1}\mu-1}{I^T\sum^{-1}I}$

$\Rightarrow\quad w=\sum^{-1}(\mu-\frac{I^T\sum^{-1}\mu-1}{I^T\sum^{-1}I})$
\end{center}

###Question_3:

####1)

\begin{center}
$E(R_p)=E[wR_1+(1-w)R_2]=wr_0+r_0-wr_0=r_0$
\end{center}

####2)

\begin{center}
$Cov(R_p)=w^2\sigma_0^2+(1-w)^2\sigma_0^2+2w(1-w)\sigma_{12}$

$\frac{\partial Cov(R_p)}{\partial w}=2w\sigma_0^2-2(1-w)\sigma_0^2+2(1-2w)\sigma_{12}=2(2w-1)(\sigma_0^2-\sigma_{12})=0$

$\Rightarrow\quad w=0.5$
\end{center}

####3)

Since the return is always $r_0$, the smallest risk protfolio has the largest Sharp ratio, i.e. Tangency protfolio:
\begin{center}
$R_N=0.5R_1+0.5R_2$
\end{center}

\newpage
###Question_4:

####a)
```{r message=FALSE, warning=FALSE}
library(tseries)
library(timeSeries)
MMMdata = get.hist.quote(instrument = "MMM",
                         start="2014-01-01", end="2014-12-31",
                         quote=c("AdjClose"),provider="yahoo",
                         compression="d")
MSFTdata = get.hist.quote(instrument = "MSFT",
                         start="2014-01-01", end="2014-12-31",
                         quote=c("AdjClose"),provider="yahoo",
                         compression="d")
Tdata = get.hist.quote(instrument = "T",
                         start="2014-01-01", end="2014-12-31",
                         quote=c("AdjClose"),provider="yahoo",
                         compression="d")
x=merge(MMMdata,MSFTdata,Tdata)
R=diff(log(x))
colnames(R)[1]="MMM"
colnames(R)[2]="MSFT"
colnames(R)[3]="ATT"
mydata=data.frame(R)
mydata=as.timeSeries(mydata)
mu.vec=apply(mydata, 2, mean)
sigma.mat=cov(mydata)
mu.vec
sigma.mat
```

####b)
```{r}
library(fPortfolio)
Spec = portfolioSpec(portfolio=list(targetReturn=0.0005,
                                    nFrontierPoints=500,
                                    riskFreeRate=0.000))
Constraints="Longonly"
efficientPortfolio(mydata, Spec, Constraints)
```

####c)
```{r}
ones=rep(1,3)
top=solve(sigma.mat)%*%ones
bot=as.numeric(t(ones)%*%solve(sigma.mat)%*%ones)
w=top/bot
w
```

####d)
```{r}
Spec=portfolioSpec(portfolio=list(targetReturn=0.0005,
                                    nFrontierPoints=500,
                                    riskFreeRate=0.0001))
tangencyPortfolio(mydata, Spec, Constraints)
```

####e)

Line ratio unchange, do not know which portfolio is used to compare.

###Question_5:

\begin{center}
$r_C=\alpha r_A+(1-\alpha)r_B$

$w=\frac{c-br_C}{ac-b^2}\sum^{-1}I+\frac{ar_C-b}{ac-b^2}\sum^{-1}\Gamma$

$\Rightarrow\quad \frac{c-b[\alpha r_A+(1-\alpha)]}{ac-b^2}\sum^{-1}I+\frac{a[\alpha r_A-(1-\alpha)r_B]-b}{ac-b^2}\sum^{-1}\Gamma$

$\Rightarrow\quad \alpha\frac{c-br_A}{ac-b^2}\sum^{-1}I+\alpha\frac{ar_A-b}{ac-b^2}\sum^{-1}\Gamma+(1-\alpha)\frac{c-br_B}{ac-b^2}\sum^{-1}I+(1-\alpha)\frac{ar_b-b}{ac-b^2}\sum^{-1}\Gamma$

$\Rightarrow\quad w=\alpha w_A + (1-\alpha)w_B$
\end{center}















