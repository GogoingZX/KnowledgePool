---
title: "ST5218_Tut6"
author: 
- Name:Zhu Xu
- User ID:E0337988
- Matriculation ID:A0191344H
date: "26/Mar/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
\rule[-5pt]{16.3cm}{0.15em}
\linespread{1.3}

### 1:

Based on the CAPM

$$
R_i = r_f+\beta_i(R_m-r_f)+\epsilon_i = (1-\beta_i)r_f+\beta_iR_m+\epsilon_i
$$

Compared with $R_i=a_i+b_iR_M+\epsilon_i$, we get $a_i=(1-\beta_i)r_i$ and $b_i=\beta_i$

Thus,
$$
a_i=(1-b_i)r_f=r_f-r_fb_i
$$
$\Rightarrow\quad c=r_f,d=-r_f$, both of them are constant.


### 2:

```{r}
library(tseries)
library(timeSeries)
name0 = ""
name0[1]="AXP"
name0[2]="BA"
name0[3]="CAT"
name0[4]="CSCO"
name0[5]="CVX"
name0[6]="DWDP"
name0[7]="DIS"
name0[8]="GE"
name0[9]="GS"
name0[10]="HD"
name0[11]="IBM"
name0[12]="INTC"
name0[13]="JNJ"
name0[14]="JPM"
name0[15]="KO"
name0[16]="MCD"
name0[17]="MMM"
name0[18]="MRK"
name0[19]="MSFT"
name0[20]="NKE"
name0[21]="PFE"
name0[22]="PG"
name0[23]="T"
name0[24]="TRV"
name0[25]="UNH"
name0[26]="UTX"
name0[27]="V"
name0[28]="VZ"
name0[29]="WMT"
name0[30]="XOM"

x = get.hist.quote(instrument = "^DJI",
                   start="2000-01-01",
                   end='2019-03-05',
                   quote = c("AdjClose"),
                   provider ="yahoo", 
                   compression = "m")
for (i in 1:30){
  xi = get.hist.quote(instrument = name0[i],
                      start="2000-01-01",
                      end='2019-03-05',
                      quote = c("AdjClose"),
                      provider = "yahoo", 
                      compression = "m")
  x = merge(x, xi)
}

R = diff(log(x))
R = na.omit(R)

coeff=matrix(0,30,2)
for(i in 1:30){
        coeff[i,1]=lm(R[,1]~R[,i])$coefficients[1]
        coeff[i,2]=lm(R[,1]~R[,i])$coefficients[2]
}
alpha=coeff[,1]
beta=coeff[,2]
```

####a)
```{r}
t.test(alpha)
t.test(beta)
```

####b)
```{r}
fm=lm(alpha~beta)
summary(fm)
```

####c)
```{r}
avergeR=apply(R,2,mean)[2:31]
fm2=lm(avergeR~beta)
summary(fm2)
```

####d)
```{r}
plot(beta,avergeR)
abline(a=0.0081959,b=0.0005832)

avergeR[which(avergeR>0.0081959+0.0005832*beta)]
```

\newpage
### 3:

$$
R_i = r_f+\beta_i(R_m-r_f)+\epsilon_i
$$
Where $R_i$ is the net return of asset $i$ during the period $[0,T]$, $R_m$ is the market net return during the same period.

$$
E(R_i)=r_f+\beta_i[E(R_m)-r_f]=r_f+\frac{cov(R_i,R_m)}{cov(R_m)}[E(R_m)-r_f]
$$
$$
E(P_t)=P_0[1+E(R_i)]=P_0(1+r_f)+\frac{cov(P_0(1+R_i),R_m)}{cov(R_m)}[E(R_m))-r_f]
$$
Thus,
$$
P_0=\frac{1}{1+r_f}[E(P_t)-\frac{cov(P_t,R_m)[E(R_m)-r_f]}{cov(R_m)}]
$$

### 4:

####a)
$$
cov(R_i,f_k)=cov(r_i+\beta_{i1}f_1+\cdots+\beta_{ik}f_k+u_i,f_k)=\beta_{ik}cov(f_k)
$$
$$
\Rightarrow\quad \beta_k=\frac{cov(R_i,f_k)}{cov(f_k)}
$$

####b)
\begin{equation*}
\begin{split}
cov(R_i)&=cov(r_i+\beta_{i1}f_1+\cdots+\beta_{ik}f_k+u_i)\\
&=cov(r_i)+cov(\beta_{i1}f_1)+\cdots+cov(\beta_{ik}f_k)+cov(u_i)\\
&=\beta_{i1}^2cov(f_1)+\cdots+\beta^2_{ik}cov(f_k)+\sigma^2_{u_i}
\end{split}
\end{equation*}

####c)
\begin{equation*}
\begin{split}
cov(R_i,R_j)&=cov(r_i,r_j)+cov(\beta_{i1}f_1,\beta_{j1}f_1)+\cdots+cov(\beta_{ik}f_k,\beta_{jk}f_k)+cov(u_i,u_j)\\
&=\beta_{i1}\beta_{j1}cov(f_1)+\cdots+\beta_{ik}\beta_{jk}cov(f_k)
\end{split}
\end{equation*}

\newpage
### 5:

####a)

$$
R = r_f+0.7F_1+0.5F_2+\frac{1}{3}(\epsilon_1+\epsilon_2+\epsilon_3)
$$

$$
\Rightarrow\quad Cov(R)=0.7^2\times0.09+0.5^2\times0.08+\frac{1}{9}(0.03+0.02+0.01)=0.0708
$$

####b)

$$
Cov(R_1)=0.8^2\times0.09+0.04^2\times0.08+0.03=0.1004
$$
Thus the proportion of total risk of asset 1 is $\frac{0.8^2\times0.09}{0.1004}=57.37\%$

####c)

$$
Cov(R_i)=\beta_i^2Cov(F_1)+\gamma_i^2Cov(F_2)+Cov(\epsilon_i)
$$
$$
Cov(R_i,R_j)=\beta_i\beta_jCov(F_1)+\gamma_i\gamma_jCov(F_2)
$$
Thus, the covariance matrix of $(R_1,R_2,R_2)$ is

$$
\sum=
\left[
\begin{matrix}
cov(R_1) & cov(R_1,R_2) & cov(R_1,R_3) \\
cov(R_2,R_1) & cov(R_2) & cov(R_2,R_3) \\
cov(R_3,R_1) & cov(R_3,R_2) & cov(R_3) \\
\end{matrix}
\right]
=
\left[
\begin{matrix}
0.1004 & 0.0664 & 0.0592 \\
0.0664 & 0.0841 & 0.0618 \\
0.0592 & 0.0618 & 0.0712 \\
\end{matrix}
\right]
$$







